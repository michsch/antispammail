<!DOCTYPE HTML>
<html class="no-js" lang="en">
<head>
  <meta charset="UTF-8">

  <title>cryptmail.js - encrypt email links for spam protection</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="apple-mobile-web-app-capable" content="no">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <link rel="shortcut icon" href="../images/favicon.ico">
  <link rel="apple-touch-icon" href="../images/apple-touch-icon.png">

  <meta name="description" content="JavaScript snippet to encrypt email links (mailto) and protect them from spam bots.">
  <meta name="keywords" content="cryptmail.js, email encryption, encrypt email, crypt email, spam protection">
  <meta name="author" content="Michael Schulze">
  <meta name="robots" content="index,follow">

  <link rel="stylesheet" href="css/dev/fonts.css">

  <!--[if ! lte IE 6]><!-->
  <link rel="stylesheet" href="css/dev/main.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link href="css/dev/patch_lte_ie8.css" rel="stylesheet" type="text/css">
  <![endif]-->
  <!--[if lte IE 7]>
  <link href="css/dev/patch_ie.css" rel="stylesheet" type="text/css">
  <![endif]-->
  <!--[if lte IE 6]>
  <link rel="stylesheet" href="http://universal-ie6-css.googlecode.com/files/ie6.1.b.css" media="screen, projection">
  <![endif]-->

  <!-- <script type="text/javascript" src="js/dev/vendor/modernizr-2.7.1.js"></script> -->
</head>
<body class="l-2col">
  <div class="ym-wrapper">
    <div class="ym-wbox">

      <header id="header" role="banner">
        <ul class="ym-skiplinks" role="navigation">
          <li><a class="ym-skip" href="#navigation">Skip to navigation (Press Enter).</a></li>
          <li><a class="ym-skip" href="#content">Skip to main content (Press Enter).</a></li>
          <li><a class="ym-skip" href="#contentinfo">Skip to footer (Press Enter).</a></li>
        </ul>
        <h1 class="logo">antispammail.js</h1>
      </header>

      <div id="main">
        <a id="content"></a>

        <p class="large">Vanilla JS, so no framework/library (jQuery etc.) needed!<br />
          <strong>Only 1.4kb for full version</strong> including encrypting (like on this page) and <strong>less than 1kb</strong> for decryption only.
        </p>


        <div class="ym-columns">
          <section class="ym-col1" role="main">
            <div class="ym-cbox-right ym-clearfix">
              <h2 class="en-light-bulb">Fight SPAM!</h2>

              <form id="cryptmail" name="cryptmail" action="post" class="ym-form" onsubmit="return false;">
                <fieldset class="ym-columnar">
                  <legend>Convert an email address in a SPAM free link.</legend>
                  <div class="ym-fbox-text ym-fbox">
                    <label for="cryptmail_email">Email</label>
                    <input id="cryptmail_email" type="email" name="email" required placeholder="Email"/>
                  </div>
                  <div class="ym-fbox">
                    <span class="ym-label">Display option</span>
                    <div class="ym-fbox-wrap">
                      <div class="ym-fbox-check">
                        <input id="cryptmail_radio_1" type="radio" value="0" name="cryptmail_radio" maxlength="100" checked />
                        <label for="cryptmail_radio_1">Use [at] instead of @ and [dot] instead of .</label>
                      </div>
                      <div class="ym-fbox-check">
                        <input id="cryptmail_radio_2" type="radio" value="1" name="cryptmail_radio" />
                        <label for="cryptmail_radio_2">Use span Tags with the class <em>crypt</em> and invisible dot as wrap for @ and .</label>
                      </div>
                    </div>
                  </div>
                </fieldset>
                <fieldset class="transparent ym-columnar">
                  <div class="ym-fbox-button ym-fbox">
                    <button class="button en-lock" onclick="antiSpamMail.encryptForm()" />Encrypt Email</button>
                  </div>
                </fieldset>
                <fieldset>
                  <legend>Result</legend>
                  <div class="ym-columnar">
                    <div class="ym-fbox-text ym-fbox">
                      <label for="cryptmail_cryptedmail">Encrypted Email</label>
                      <input id="cryptmail_cryptedmail" type="text" name="cryptmail_cryptedmail" readonly />
                    </div>
                  </div>
                  <div class="ym-fbox-text ym-fbox">
                    <label for="cryptmail_html">Full HTML</label>
                    <textarea name="cryptmail_html" id="cryptmail_html" cols="30" rows="5" readonly></textarea>
                  </div>
                </fieldset>

              </form>
            </div>
          </section>
          <aside class="ym-col3" role="complementary">
            <div class="ym-cbox-left ym-clearfix">
              <h2>Download</h2>
              <section class="download">
                <a class="button zip en-download" href="http://github.com/michsch/antispammail/zipball/master">
                  ZIP Download
                </a>
                <a class="button tar en-download" href="http://github.com/michsch/antispammail/tarball/master">
                  TAR Download
                </a>
                <a class="button tar en-s-github" href="http://github.com/michsch/antispammail/" title="github.com/michsch/antispammail">
                  Fork me on GitHub
                </a>
              </section>
              <h3>Or use Bower</h3>
              <pre class="bash small"><code>$ bower install antispammail</code></pre>

            </div>
            <div id="ie_clearing"> &#160; </div>
          </aside>
        </div>

        <hr>

        <h2>How to use</h2>
        <p>Just include the <strong>antispammail.js</strong> file in your documents header or just before the closing body tag. If you use the span Tags with classname <code>crypt</code> than you should load the CSS file too or copy the styles inside your stylesheet.</p>
        <p>If you only want to use the script for decrypting you don't have to load the complete version. Just use <strong>antispammail-decrypt.js</strong> instead.</p>

        <h3>Examples</h3>

        <h4>HTML with normal mailto link</h4>
        <div class="ym-grid">
          <div class="ym-g75 ym-gl">
            <div class="ym-gbox-left">
              <pre class="prettyprint html light"><code>&lt;a href="mailto:my@email.com"&gt;
  my@email.com
&lt;/a&gt;</code></pre>
            </div>
          </div>
          <div class="ym-g25 ym-gr">
            <div class="ym-gbox-right">
              <p><a href="mailto:my@email.com">my@email.com</a></p>
            </div>
          </div>
        </div>

        <h4>HTML with easy encryption (no CSS needed)</h4>
        <div class="ym-grid">
          <div class="ym-g75 ym-gl">
            <div class="ym-gbox-left">
              <pre class="prettyprint html light"><code>&lt;a href="javascript:antiSpamMail.linkDecrypt('nbjmup;nzAfnbjm/dpn');"&gt;
  my [at] email [dot] com
&lt;/a&gt;</code></pre>
            </div>
          </div>
          <div class="ym-g25 ym-gr">
            <div class="ym-gbox-right">
              <p><a href="javascript:antiSpamMail.linkDecrypt('nbjmup;nzAfnbjm/dpn');">my [at] email [dot] com</a></p>
            </div>
          </div>
        </div>

        <div class="ym-grid">
          <div class="ym-g75 ym-gl">
            <div class="ym-gbox-left">
              <pre class="prettyprint html light"><code>&lt;a href="javascript:antiSpamMail.linkDecrypt('nbjmup;nzAfnbjm/dpn');"&gt;
  Write me an email!
&lt;/a&gt;</code></pre>
            </div>
          </div>
          <div class="ym-g25 ym-gr">
            <div class="ym-gbox-right">
              <p><a href="javascript:antiSpamMail.linkDecrypt('nbjmup;nzAfnbjm/dpn');">Write me an email!</a></p>
            </div>
          </div>
        </div>

        <h4>HTML with advanced encryption (CSS needed to hide dots)</h4>
        <div class="ym-grid">
          <div class="ym-g75 ym-gl">
            <div class="ym-gbox-left">
              <pre class="prettyprint html light"><code>&lt;a href="javascript:antiSpamMail.linkDecrypt('nbjmup;nzAfnbjm/dpn');"&gt;
  my&lt;span class="crypt" aria-hidden="true"&gt;.&lt;/span&gt;@&lt;span class="crypt" aria-hidden="true"&gt;.&lt;/span&gt;email&lt;span class="crypt" aria-hidden="true"&gt;.&lt;/span&gt;.&lt;span class="crypt" aria-hidden="true"&gt;.&lt;/span&gt;com
&lt;/a&gt;</code></pre>
            </div>
          </div>
          <div class="ym-g25 ym-gr">
            <div class="ym-gbox-right">
              <p><a href="javascript:antiSpamMail.linkDecrypt('nbjmup;nzAfnbjm/dpn');">my<span class="crypt" aria-hidden="true">.</span>@<span class="crypt" aria-hidden="true">.</span>email<span class="crypt" aria-hidden="true">.</span>.<span class="crypt" aria-hidden="true">.</span>com</a></p>
            </div>
          </div>
        </div>

        <h3>CSS for advanced encryption</h3>
        <p>I use the <a href="http://nicolasgallagher.com/another-css-image-replacement-technique/" title="Website of Nicolas Gallagher">image replacement method by Nicolas Gallagher</a>:
</p>
        <pre class="prettyprint light css"><code>.crypt {
  font: 0/0 a;
  text-shadow: none;
  color: transparent;
  border: 0;
  background-color: transparent;
}</code></pre>

        <h2>JavaScript source code</h2>
        <pre class="prettyprint linenums dark"><code>;(function(window, document, undefined){
  'use strict';

  var AntiSpamMail, AntiSpamMailProto, antiSpamMail;
  AntiSpamMail = function() {};
  AntiSpamMailProto = {
    _version: '0.0.1',
    encryptFn: 'antiSpamMail.linkDecrypt'
  };
  AntiSpamMail.prototype = AntiSpamMailProto;
  window.antiSpamMail = antiSpamMail = new AntiSpamMail();


  /**
   * Crypt given mail
   *
   * @param string email address
   * @param boolean true
  */

  antiSpamMail.encrypt = function(email) {
    var encryptedMail, i, mailtoEmail, n;
    n = 0;
    encryptedMail = '';
    mailtoEmail = 'mailto:' + email;
    i = 0;
    while (i < mailtoEmail.length) {
      n = mailtoEmail.charCodeAt(i);
      if (n >= 8364) {
        n = 128;
      }
      encryptedMail += String.fromCharCode(n + 1);
      i++;
    }
    return encryptedMail;
  };
  antiSpamMail.encryptForm = function(formName, fieldName) {
    var cryptform, email, emailHtml, encryptedMail, fieldShowEncryptedHtml, fieldShowEncryptedMail, i, radioObj, radioValue;
    formName = formName || 'cryptmail';
    fieldName = fieldName || 'cryptmail_email';
    fieldShowEncryptedMail = 'cryptmail_cryptedmail';
    fieldShowEncryptedHtml = 'cryptmail_html';
    cryptform = document.forms[formName];
    email = cryptform[fieldName].value;
    if (cryptform.cryptmail_email.value.length < 4) {
      return false;
    }
    radioObj = cryptform.cryptmail_radio;
    if (radioObj.length > 0) {
      i = 0;
      while (i < radioObj.length) {
        radioValue = parseInt(radioObj[i].checked ? radioObj[i].value : void 0, 10);
        i++;
      }
    } else {
      radioValue = 0;
    }
    if (radioValue === 1) {
      emailHtml = email.replace(/\./g, '&lt;span class="crypt"&gt;.&lt;/span&gt;.&lt;span class="crypt" aria-hidden="true"&gt;.&lt;/span&gt;');
      emailHtml = emailHtml.replace(/@/, '&lt;span class="crypt"&gt;.&lt;/span&gt;@&lt;span class="crypt" aria-hidden="true"&gt;.&lt;/span&gt;');
    } else {
      emailHtml = email.replace(/\./g, ' [dot] ');
      emailHtml = emailHtml.replace(/@/, ' [at] ');
    }
    encryptedMail = this.encrypt(email);
    cryptform[fieldShowEncryptedMail].value = encryptedMail;
    cryptform[fieldShowEncryptedHtml].value = '<a href="javascript:' + this.encryptFn + '(\'' + encryptedMail + '\');">' + emailHtml + '</a>';
    return true;
  };


  /**
   * Uncrypt the email address and returns the valid href
   *
   * @param string the crypted string
   * @return string valid href
  */

  antiSpamMail.decrypt = function(encryptedMail) {
    var email, i, n;
    n = 0;
    email = '';
    i = 0;
    while (i < encryptedMail.length) {
      n = encryptedMail.charCodeAt(i);
      if (n >= 8364) {
        n = 128;
      }
      email += String.fromCharCode(n - 1);
      i++;
    }
    return email;
  };
  /**
   * Public function for A tags
   *
   * @param string the crypted string
   * @return boolean true
  */

  antiSpamMail.linkDecrypt = function(encryptedMail) {
    location.href = this.decrypt(encryptedMail);
    return true;
  };


  if (typeof define === 'function' && define.amd) {
    define('antiSpamMail', [], function() { return antiSpamMail; });
  }
})(this, document);</code></pre>

      </div>
    </div>
  </div>

  <footer id="footer" role="contentinfo">
    <a id="contentinfo"></a>
    <div class="ym-wrapper">
      <div class="ym-wbox">
        <p class="copy">&copy; 2011 <a href="javascript:antiSpamMail.linkDecrypt('nbjmup;nt,dpejohAnjditdi/ef');">Michael Schulze</a></p>
      </div>
    </div>
  </footer>

  <a href="https://github.com/michsch/antispammail">
    <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub">
  </a>

  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="js/dev/vendor/jquery-1.10.2.min.js"><\/script>');</script>
  <script data-main="js/dev/main" src="js/dev/vendor/require.js"></script>

</body>
</html>
